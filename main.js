/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);
var __publicField = (obj, key, value) => {
  __defNormalProp(obj, typeof key !== "symbol" ? key + "" : key, value);
  return value;
};

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => GotoHeadingPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian3 = require("obsidian");

// src/utility.ts
function headingsForActiveFile(app) {
  let activeFile = app.workspace.getActiveFile();
  if (!activeFile)
    return void 0;
  const fileCache = app.metadataCache.getFileCache(activeFile);
  return fileCache == null ? void 0 : fileCache.headings;
}
function goAndScrollToLine(editor, line) {
  editor.setCursor(line);
  const position = editor.getCursor();
  const range = editor.wordAt(position);
  if (!range)
    return;
  editor.scrollIntoView(range, true);
}

// src/heading_modal.ts
var import_obsidian = require("obsidian");
var HeadingModal = class extends import_obsidian.FuzzySuggestModal {
  constructor() {
    super(...arguments);
    __publicField(this, "items", []);
    __publicField(this, "defaultItemIndex", -1);
    __publicField(this, "onChoose");
    __publicField(this, "settings");
  }
  onOpen() {
    super.onOpen();
    if (this.defaultItemIndex >= 0 && this.defaultItemIndex < this.items.length) {
      let chooser = this["chooser"];
      for (let i = 0; i < this.defaultItemIndex; i++) {
        chooser["moveDown"](new KeyboardEvent("keydown", { key: "ArrowDown" }));
      }
    }
  }
  getItems() {
    return this.items;
  }
  getItemText(item) {
    return item.heading;
  }
  onChooseItem(item, evt) {
    var _a;
    (_a = this.onChoose) == null ? void 0 : _a.call(this, item);
  }
  renderSuggestion(item, el) {
    const isSearching = this.inputEl.value.length > 0;
    const level = item.item.level;
    const iconName = level >= 1 && level <= 6 ? `heading-${level}` : "heading";
    el.classList.add("join-gotoheading-headingmodal-suggestion");
    if (this.settings.highlightCurrentHeading && this.defaultItemIndex >= 0 && this.items.indexOf(item.item) == this.defaultItemIndex) {
      el.classList.add("join-gotoheading-headingmodal-suggestion-default");
    }
    if (isSearching) {
      (0, import_obsidian.setIcon)(el, iconName);
    } else {
      el.createDiv({
        text: "#".repeat(level),
        cls: "join-gotoheading-headingmodal-suggestion-spacer"
      });
    }
    const titleEl = el.createSpan({ cls: "title" });
    super.renderSuggestion(item, titleEl);
    if (isSearching) {
      let smallEl = el.createEl("small", { text: this.parentHeadingString(item.item), cls: "path" });
    } else {
      let smallEl = el.createEl("small", { cls: "icon" });
      (0, import_obsidian.setIcon)(smallEl, iconName);
    }
  }
  parentHeadingString(item) {
    let string = "";
    while (item) {
      const parentIndex = this.items.findLastIndex(
        (heading) => heading.line < item.line && heading.level < item.level
      );
      if (parentIndex < 0)
        break;
      const parent = this.items[parentIndex];
      if (string.length > 0) {
        string = `${parent.heading} > ${string}`;
      } else {
        string = parent.heading;
      }
      item = parent;
    }
    return string;
  }
};

// src/settings_tab.ts
var import_obsidian2 = require("obsidian");
var GotoHeadingSettingTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    __publicField(this, "plugin");
    this.plugin = plugin;
  }
  display() {
    let { containerEl } = this;
    containerEl.empty();
    new import_obsidian2.Setting(containerEl).setName("Highlight current heading").setDesc("Emphasize the current heading in the switcher").addToggle((toggle) => {
      toggle.setValue(this.plugin.settings.highlightCurrentHeading).onChange(async (value) => {
        this.plugin.settings.highlightCurrentHeading = toggle.getValue();
        await this.plugin.saveSettings();
      });
    });
  }
};

// src/settings.ts
var DEFAULT_SETTINGS = {
  highlightCurrentHeading: true
};

// src/main.ts
var GotoHeadingPlugin = class extends import_obsidian3.Plugin {
  constructor() {
    super(...arguments);
    __publicField(this, "settings");
  }
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new GotoHeadingSettingTab(this.app, this));
    this.addCommand({
      id: "join-gotoheading-previous",
      name: "Go To Heading: Previous Heading",
      editorCallback: (editor, view) => {
        this.goToRelativeHeading(editor, view, -1);
      }
    });
    this.addCommand({
      id: "join-gotoheading-next",
      name: "Go To Heading: Next Heading",
      editorCallback: (editor, view) => {
        this.goToRelativeHeading(editor, view, 1);
      }
    });
    this.addCommand({
      id: "join-gotoheading-switcher",
      name: "Go To Heading: Open Switcher",
      editorCallback: (editor, view) => {
        this.openHeadingSwitcher(editor, view);
      }
    });
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  goToRelativeHeading(editor, view, offset) {
    if (offset == 0)
      return;
    const headings = headingsForActiveFile(this.app);
    if (!(headings == null ? void 0 : headings.length))
      return;
    const line = editor.getCursor().line;
    const nearestHeadingIndex = headings.findLastIndex((heading2) => heading2.position.start.line <= line);
    if (nearestHeadingIndex < 0)
      return;
    const nearestHeading = headings[nearestHeadingIndex];
    if (offset == -1 && line > nearestHeading.position.end.line) {
      offset = 0;
    }
    let idx = nearestHeadingIndex + offset;
    if (idx < 0 || idx >= headings.length)
      return;
    const heading = headings[idx];
    goAndScrollToLine(editor, heading.position.start.line);
  }
  openHeadingSwitcher(editor, view) {
    const headings = headingsForActiveFile(this.app);
    if (!(headings == null ? void 0 : headings.length))
      return;
    let modal = new HeadingModal(this.app);
    modal.setInstructions([
      { command: "\u2191\u2193", purpose: "to navigate" },
      { command: "\u21B5", purpose: "to jump to heading" },
      { command: "esc", purpose: "to dismiss" }
    ]);
    modal.setPlaceholder("Go to heading...");
    modal.items = headings.map((heading) => ({
      heading: heading.heading,
      level: heading.level,
      line: heading.position.start.line
    }));
    modal.onChoose = (item) => {
      goAndScrollToLine(editor, item.line);
      modal.close();
    };
    const line = editor.getCursor().line;
    modal.defaultItemIndex = headings.findLastIndex((heading) => heading.position.start.line <= line);
    modal.settings = this.settings;
    modal.open();
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3V0aWxpdHkudHMiLCAic3JjL2hlYWRpbmdfbW9kYWwudHMiLCAic3JjL3NldHRpbmdzX3RhYi50cyIsICJzcmMvc2V0dGluZ3MudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IEVkaXRvciwgTm90aWNlLCBNYXJrZG93blZpZXcsIFBsdWdpbiwgRWRpdG9yUmFuZ2UsIGxpdmVQcmV2aWV3U3RhdGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IGdvQW5kU2Nyb2xsVG9MaW5lLCBoZWFkaW5nc0ZvckFjdGl2ZUZpbGUgfSBmcm9tIFwiLi91dGlsaXR5XCI7XG5pbXBvcnQgeyBIZWFkaW5nTW9kYWwgfSBmcm9tIFwiLi9oZWFkaW5nX21vZGFsXCI7XG5pbXBvcnQgeyBHb3RvSGVhZGluZ1NldHRpbmdUYWIgfSBmcm9tIFwiLi9zZXR0aW5nc190YWJcIjtcbmltcG9ydCB7IERFRkFVTFRfU0VUVElOR1MsIEdvdG9IZWFkaW5nU2V0dGluZ3MgfSBmcm9tIFwiLi9zZXR0aW5nc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHb3RvSGVhZGluZ1BsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG5cdHNldHRpbmdzOiBHb3RvSGVhZGluZ1NldHRpbmdzO1xuXG5cdGFzeW5jIG9ubG9hZCgpIHtcblx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBHb3RvSGVhZGluZ1NldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcblxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRpZDogXCJqb2luLWdvdG9oZWFkaW5nLXByZXZpb3VzXCIsXG5cdFx0XHRuYW1lOiBcIkdvIFRvIEhlYWRpbmc6IFByZXZpb3VzIEhlYWRpbmdcIixcblx0XHRcdGVkaXRvckNhbGxiYWNrOiAoZWRpdG9yOiBFZGl0b3IsIHZpZXc6IE1hcmtkb3duVmlldykgPT4ge1xuXHRcdFx0XHR0aGlzLmdvVG9SZWxhdGl2ZUhlYWRpbmcoZWRpdG9yLCB2aWV3LCAtMSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiBcImpvaW4tZ290b2hlYWRpbmctbmV4dFwiLFxuXHRcdFx0bmFtZTogXCJHbyBUbyBIZWFkaW5nOiBOZXh0IEhlYWRpbmdcIixcblx0XHRcdGVkaXRvckNhbGxiYWNrOiAoZWRpdG9yOiBFZGl0b3IsIHZpZXc6IE1hcmtkb3duVmlldykgPT4ge1xuXHRcdFx0XHR0aGlzLmdvVG9SZWxhdGl2ZUhlYWRpbmcoZWRpdG9yLCB2aWV3LCAxKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6IFwiam9pbi1nb3RvaGVhZGluZy1zd2l0Y2hlclwiLFxuXHRcdFx0bmFtZTogXCJHbyBUbyBIZWFkaW5nOiBPcGVuIFN3aXRjaGVyXCIsXG5cdFx0XHRlZGl0b3JDYWxsYmFjazogKGVkaXRvcjogRWRpdG9yLCB2aWV3OiBNYXJrZG93blZpZXcpID0+IHtcblx0XHRcdFx0dGhpcy5vcGVuSGVhZGluZ1N3aXRjaGVyKGVkaXRvciwgdmlldyk7XG5cdFx0XHR9LFxuXHRcdH0pO1xuXHR9XG5cblx0YXN5bmMgbG9hZFNldHRpbmdzKCkge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuXHR9XG5cblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgZ29Ub1JlbGF0aXZlSGVhZGluZyhlZGl0b3I6IEVkaXRvciwgdmlldzogTWFya2Rvd25WaWV3LCBvZmZzZXQ6IG51bWJlcikge1xuXHRcdGlmIChvZmZzZXQgPT0gMCkgcmV0dXJuO1xuXG5cdFx0Y29uc3QgaGVhZGluZ3MgPSBoZWFkaW5nc0ZvckFjdGl2ZUZpbGUodGhpcy5hcHApO1xuXHRcdGlmKCFoZWFkaW5ncz8ubGVuZ3RoKSByZXR1cm47XG5cdFx0XG5cdFx0Ly8gR2V0IHRoZSBpbmRleCBvZiB0aGUgbmVhcmVzdCBoZWFkaW5nIHRvIHRoZSBjdXJzb3Jcblx0XHRjb25zdCBsaW5lID0gZWRpdG9yLmdldEN1cnNvcigpLmxpbmU7XG5cdFx0Y29uc3QgbmVhcmVzdEhlYWRpbmdJbmRleCA9IGhlYWRpbmdzLmZpbmRMYXN0SW5kZXgoaGVhZGluZyA9PiBoZWFkaW5nLnBvc2l0aW9uLnN0YXJ0LmxpbmUgPD0gbGluZSk7XG5cdFx0aWYgKG5lYXJlc3RIZWFkaW5nSW5kZXggPCAwKSByZXR1cm47XG5cblx0XHRjb25zdCBuZWFyZXN0SGVhZGluZyA9IGhlYWRpbmdzW25lYXJlc3RIZWFkaW5nSW5kZXhdO1xuXHRcdGlmKG9mZnNldCA9PSAtMSAmJiBsaW5lID4gbmVhcmVzdEhlYWRpbmcucG9zaXRpb24uZW5kLmxpbmUpIHtcblx0XHRcdG9mZnNldCA9IDA7XG5cdFx0fVxuXG5cdFx0Ly8gQ29tcHV0ZSB0aGUgbmV3IGhlYWRpbmcgaW5kZXhcblx0XHRsZXQgaWR4ID0gbmVhcmVzdEhlYWRpbmdJbmRleCArIG9mZnNldDtcblx0XHRpZihpZHggPCAwIHx8IGlkeCA+PSBoZWFkaW5ncy5sZW5ndGgpIHJldHVybjtcblxuXHRcdC8vIE1vdmUgdGhlIGN1cnNvciB0byB0aGUgbmV3IGhlYWRpbmdcblx0XHRjb25zdCBoZWFkaW5nID0gaGVhZGluZ3NbaWR4XTtcblx0XHRnb0FuZFNjcm9sbFRvTGluZShlZGl0b3IsIGhlYWRpbmcucG9zaXRpb24uc3RhcnQubGluZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgb3BlbkhlYWRpbmdTd2l0Y2hlcihlZGl0b3I6IEVkaXRvciwgdmlldzogTWFya2Rvd25WaWV3KSB7XG5cdFx0Y29uc3QgaGVhZGluZ3MgPSBoZWFkaW5nc0ZvckFjdGl2ZUZpbGUodGhpcy5hcHApO1xuXHRcdGlmKCFoZWFkaW5ncz8ubGVuZ3RoKSByZXR1cm47XG5cblx0XHRsZXQgbW9kYWwgPSBuZXcgSGVhZGluZ01vZGFsKHRoaXMuYXBwKTtcblx0XHRtb2RhbC5zZXRJbnN0cnVjdGlvbnMoW1xuXHRcdFx0eyBjb21tYW5kOiBcIlx1MjE5MVx1MjE5M1wiLCBwdXJwb3NlOiBcInRvIG5hdmlnYXRlXCIgfSxcblx0XHRcdHsgY29tbWFuZDogXCJcdTIxQjVcIiwgcHVycG9zZTogXCJ0byBqdW1wIHRvIGhlYWRpbmdcIiB9LFxuXHRcdFx0eyBjb21tYW5kOiBcImVzY1wiLCBwdXJwb3NlOiBcInRvIGRpc21pc3NcIiB9LFxuXHRcdF0pO1xuXHRcdG1vZGFsLnNldFBsYWNlaG9sZGVyKFwiR28gdG8gaGVhZGluZy4uLlwiKTtcblxuXHRcdG1vZGFsLml0ZW1zID0gaGVhZGluZ3MubWFwKGhlYWRpbmcgPT4gKHtcblx0XHRcdGhlYWRpbmc6IGhlYWRpbmcuaGVhZGluZyxcblx0XHRcdGxldmVsOiBoZWFkaW5nLmxldmVsLFxuXHRcdFx0bGluZTogaGVhZGluZy5wb3NpdGlvbi5zdGFydC5saW5lXG5cdFx0fSkpO1xuXG5cdFx0bW9kYWwub25DaG9vc2UgPSAoaXRlbSkgPT4ge1xuXHRcdFx0Z29BbmRTY3JvbGxUb0xpbmUoZWRpdG9yLCBpdGVtLmxpbmUpO1xuXHRcdFx0bW9kYWwuY2xvc2UoKTtcblx0XHR9O1xuXG5cdFx0Ly8gR2V0IHRoZSBpbmRleCBvZiB0aGUgbmVhcmVzdCBoZWFkaW5nIHRvIHRoZSBjdXJzb3Jcblx0XHRjb25zdCBsaW5lID0gZWRpdG9yLmdldEN1cnNvcigpLmxpbmU7XG5cdFx0bW9kYWwuZGVmYXVsdEl0ZW1JbmRleCA9IGhlYWRpbmdzLmZpbmRMYXN0SW5kZXgoaGVhZGluZyA9PiBoZWFkaW5nLnBvc2l0aW9uLnN0YXJ0LmxpbmUgPD0gbGluZSk7XG5cdFx0bW9kYWwuc2V0dGluZ3MgPSB0aGlzLnNldHRpbmdzO1xuXG5cdFx0bW9kYWwub3BlbigpO1xuXHR9XG59IiwgImltcG9ydCB7IEFwcCwgRWRpdG9yLCBIZWFkaW5nQ2FjaGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGhlYWRpbmdzRm9yQWN0aXZlRmlsZShhcHA6IEFwcCkge1xuXHQvLyBHZXQgdGhlIGFjdGl2ZSBmaWxlJ3MgaGVhZGluZ3MgZnJvbSB0aGUgRmlsZSBDYWNoZVxuXHRsZXQgYWN0aXZlRmlsZSA9IGFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRpZiAoIWFjdGl2ZUZpbGUpIHJldHVybiB1bmRlZmluZWQ7XG5cdGNvbnN0IGZpbGVDYWNoZSA9IGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShhY3RpdmVGaWxlKTtcblxuXHRyZXR1cm4gZmlsZUNhY2hlPy5oZWFkaW5ncztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdvQW5kU2Nyb2xsVG9MaW5lKGVkaXRvcjogRWRpdG9yLCBsaW5lOiBudW1iZXIpIHtcblx0ZWRpdG9yLnNldEN1cnNvcihsaW5lKTtcblxuXHQvLyBBbHNvIHNjcm9sbCB0byB0aGUgaGVhZGluZyB0byBlbnN1cmUgaXRzIGNvbnRlbnRzIGFyZSB2aXNpYmxlXG5cdGNvbnN0IHBvc2l0aW9uID0gZWRpdG9yLmdldEN1cnNvcigpO1xuXHRjb25zdCByYW5nZSA9IGVkaXRvci53b3JkQXQocG9zaXRpb24pO1xuXHRpZiAoIXJhbmdlKSByZXR1cm47XG5cdGVkaXRvci5zY3JvbGxJbnRvVmlldyhyYW5nZSwgdHJ1ZSk7XG59IiwgImltcG9ydCB7IEFwcCwgRWRpdG9yLCBGdXp6eU1hdGNoLCBGdXp6eVN1Z2dlc3RNb2RhbCwgTm90aWNlLCBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBHb3RvSGVhZGluZ1NldHRpbmdzIH0gZnJvbSBcIi4vc2V0dGluZ3NcIjtcblxuaW50ZXJmYWNlIEhlYWRpbmdTdWdnZXN0aW9uIHtcblx0aGVhZGluZzogc3RyaW5nO1xuXHRsZXZlbDogbnVtYmVyO1xuXHRsaW5lOiBudW1iZXI7XG59XG5cbnR5cGUgSGVhZGluZ01vZGFsQ2FsbGJhY2sgPSAoaXRlbTogSGVhZGluZ1N1Z2dlc3Rpb24pID0+IHZvaWQ7XG5cbmV4cG9ydCBjbGFzcyBIZWFkaW5nTW9kYWwgZXh0ZW5kcyBGdXp6eVN1Z2dlc3RNb2RhbDxIZWFkaW5nU3VnZ2VzdGlvbj4ge1xuXHRwdWJsaWMgaXRlbXM6IEhlYWRpbmdTdWdnZXN0aW9uW10gPSBbXTtcblx0cHVibGljIGRlZmF1bHRJdGVtSW5kZXg6IG51bWJlciA9IC0xO1xuXHRwdWJsaWMgb25DaG9vc2U6IEhlYWRpbmdNb2RhbENhbGxiYWNrO1xuXHRwdWJsaWMgc2V0dGluZ3M6IEdvdG9IZWFkaW5nU2V0dGluZ3M7XG5cblx0b25PcGVuKCkge1xuXHRcdHN1cGVyLm9uT3BlbigpO1xuXG5cdFx0aWYodGhpcy5kZWZhdWx0SXRlbUluZGV4ID49IDAgJiYgdGhpcy5kZWZhdWx0SXRlbUluZGV4IDwgdGhpcy5pdGVtcy5sZW5ndGgpIHtcblx0XHRcdC8vRklYTUU6IFRoaXMgaXMgYSBoYWNrIHRvIHNlbGVjdCB0aGUgZGVmYXVsdCBpdGVtLCB3aGlsZSB3ZSB3YWl0IGZvciBhIHByb3BlciBBUElcblx0XHRcdGxldCBjaG9vc2VyID0gKHRoaXMgYXMgYW55KVsnY2hvb3NlciddO1xuXHRcdFx0Zm9yKGxldCBpID0gMDsgaSA8IHRoaXMuZGVmYXVsdEl0ZW1JbmRleDsgaSsrKSB7XG5cdFx0XHRcdGNob29zZXJbJ21vdmVEb3duJ10obmV3IEtleWJvYXJkRXZlbnQoXCJrZXlkb3duXCIsIHsga2V5OiBcIkFycm93RG93blwiIH0pKTtcblx0XHRcdH1cblxuXHRcdFx0Ly9GSVhNRTogQWRkIGEgY2xhc3MgdG8gc3R5bGUgdGhlIGRlZmF1bHQgaXRlbVxuXHRcdFx0Ly8gY29uc3QgZWwgPSBjaG9vc2VyWydzdWdnZXN0aW9ucyddW3RoaXMuZGVmYXVsdEl0ZW1JbmRleF07XG5cdFx0XHQvLyBlbC5jbGFzc0xpc3QuYWRkKFwiam9pbi1nb3RvaGVhZGluZy1oZWFkaW5nbW9kYWwtc3VnZ2VzdGlvbi1kZWZhdWx0XCIpO1xuXHRcdH1cblx0fVxuXG5cdGdldEl0ZW1zKCk6IEhlYWRpbmdTdWdnZXN0aW9uW10ge1xuXHRcdHJldHVybiB0aGlzLml0ZW1zO1xuXHR9XG5cblx0Z2V0SXRlbVRleHQoaXRlbTogSGVhZGluZ1N1Z2dlc3Rpb24pOiBzdHJpbmcge1xuXHRcdHJldHVybiBpdGVtLmhlYWRpbmc7XG5cdH1cblxuXHRvbkNob29zZUl0ZW0oaXRlbTogSGVhZGluZ1N1Z2dlc3Rpb24sIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcblx0XHR0aGlzLm9uQ2hvb3NlPy4oaXRlbSk7XG5cdH1cblxuXHRyZW5kZXJTdWdnZXN0aW9uKGl0ZW06IEZ1enp5TWF0Y2g8SGVhZGluZ1N1Z2dlc3Rpb24+LCBlbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcblx0XHRjb25zdCBpc1NlYXJjaGluZyA9IHRoaXMuaW5wdXRFbC52YWx1ZS5sZW5ndGggPiAwO1xuXHRcdGNvbnN0IGxldmVsID0gaXRlbS5pdGVtLmxldmVsO1xuXHRcdGNvbnN0IGljb25OYW1lID0gbGV2ZWwgPj0gMSAmJiBsZXZlbCA8PSA2ID8gYGhlYWRpbmctJHtsZXZlbH1gIDogXCJoZWFkaW5nXCI7XG5cdFx0XG5cdFx0ZWwuY2xhc3NMaXN0LmFkZChcImpvaW4tZ290b2hlYWRpbmctaGVhZGluZ21vZGFsLXN1Z2dlc3Rpb25cIik7XG5cblx0XHRpZih0aGlzLnNldHRpbmdzLmhpZ2hsaWdodEN1cnJlbnRIZWFkaW5nICYmIHRoaXMuZGVmYXVsdEl0ZW1JbmRleCA+PSAwICYmIHRoaXMuaXRlbXMuaW5kZXhPZihpdGVtLml0ZW0pID09IHRoaXMuZGVmYXVsdEl0ZW1JbmRleCkge1xuXHRcdFx0ZWwuY2xhc3NMaXN0LmFkZChcImpvaW4tZ290b2hlYWRpbmctaGVhZGluZ21vZGFsLXN1Z2dlc3Rpb24tZGVmYXVsdFwiKTtcblx0XHR9XG5cblx0XHRpZihpc1NlYXJjaGluZykge1xuXHRcdFx0Ly8gU2V0IGEgaGVhZGluZyBpY29uXG5cdFx0XHRzZXRJY29uKGVsLCBpY29uTmFtZSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIFVzZSBhIHNwYWNlciB0byByZXByZXNlbnQgdGhlIGhlYWRpbmcgbGV2ZWxcblx0XHRcdGVsLmNyZWF0ZURpdih7XG5cdFx0XHRcdHRleHQ6IFwiI1wiLnJlcGVhdChsZXZlbCksXG5cdFx0XHRcdGNsczogXCJqb2luLWdvdG9oZWFkaW5nLWhlYWRpbmdtb2RhbC1zdWdnZXN0aW9uLXNwYWNlclwiXG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHQvLyBEaXNwbGF5IHRpdGxlIGFzIHJlbmRlcmVkIGJ5IEZ1enp5U3VnZ2VzdE1vZGFsXG5cdFx0Y29uc3QgdGl0bGVFbCA9IGVsLmNyZWF0ZVNwYW4oeyBjbHM6IFwidGl0bGVcIn0pO1xuXHRcdHN1cGVyLnJlbmRlclN1Z2dlc3Rpb24oaXRlbSwgdGl0bGVFbCk7XG5cblx0XHQvLyBJZiBhIHNlYXJjaCBpcyBvbmdvaW5nLCBkaXNwbGF5IHBhcmVudCBoZWFkaW5nIGluZm9ybWF0aW9uXG5cdFx0aWYoaXNTZWFyY2hpbmcpIHtcblx0XHRcdGxldCBzbWFsbEVsID0gZWwuY3JlYXRlRWwoXCJzbWFsbFwiLCB7IHRleHQ6IHRoaXMucGFyZW50SGVhZGluZ1N0cmluZyhpdGVtLml0ZW0pLCBjbHM6IFwicGF0aFwiIH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRsZXQgc21hbGxFbCA9IGVsLmNyZWF0ZUVsKFwic21hbGxcIiwgeyBjbHM6IFwiaWNvblwiIH0pO1xuXHRcdFx0c2V0SWNvbihzbWFsbEVsLCBpY29uTmFtZSk7XG5cdFx0fVxuXHR9XG5cblx0cHJvdGVjdGVkIHBhcmVudEhlYWRpbmdTdHJpbmcoaXRlbTogSGVhZGluZ1N1Z2dlc3Rpb24pOiBzdHJpbmcge1xuXHRcdGxldCBzdHJpbmcgPSBcIlwiO1xuXG5cdFx0d2hpbGUoaXRlbSkge1xuXHRcdFx0Y29uc3QgcGFyZW50SW5kZXggPSB0aGlzLml0ZW1zLmZpbmRMYXN0SW5kZXgoXG5cdFx0XHRcdGhlYWRpbmcgPT4gaGVhZGluZy5saW5lIDwgaXRlbS5saW5lXG5cdFx0XHRcdCYmIGhlYWRpbmcubGV2ZWwgPCBpdGVtLmxldmVsXG5cdFx0XHRcdCk7XG5cdFx0XHRpZihwYXJlbnRJbmRleCA8IDApIGJyZWFrO1xuXHRcdFx0Y29uc3QgcGFyZW50ID0gdGhpcy5pdGVtc1twYXJlbnRJbmRleF07XG5cblx0XHRcdGlmKHN0cmluZy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdHN0cmluZyA9IGAke3BhcmVudC5oZWFkaW5nfSA+ICR7c3RyaW5nfWA7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRzdHJpbmcgPSBwYXJlbnQuaGVhZGluZztcblx0XHRcdH1cblx0XHRcdGl0ZW0gPSBwYXJlbnQ7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHN0cmluZztcblx0fVxufSIsICJpbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBHb3RvSGVhZGluZ1BsdWdpbiBmcm9tIFwiLi9tYWluXCI7XG5cbmV4cG9ydCBjbGFzcyBHb3RvSGVhZGluZ1NldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcblx0cGx1Z2luOiBHb3RvSGVhZGluZ1BsdWdpbjtcblxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBHb3RvSGVhZGluZ1BsdWdpbikge1xuXHRcdHN1cGVyKGFwcCwgcGx1Z2luKTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0fVxuXG5cdGRpc3BsYXkoKSB7XG5cdFx0bGV0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cblx0XHRjb250YWluZXJFbC5lbXB0eSgpO1xuXHRcdFxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoXCJIaWdobGlnaHQgY3VycmVudCBoZWFkaW5nXCIpXG5cdFx0XHQuc2V0RGVzYyhcIkVtcGhhc2l6ZSB0aGUgY3VycmVudCBoZWFkaW5nIGluIHRoZSBzd2l0Y2hlclwiKVxuXHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiB7XG5cdFx0XHRcdHRvZ2dsZVxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5oaWdobGlnaHRDdXJyZW50SGVhZGluZylcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5oaWdobGlnaHRDdXJyZW50SGVhZGluZyA9IHRvZ2dsZS5nZXRWYWx1ZSgpO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0fVxufSIsICJleHBvcnQgaW50ZXJmYWNlIEdvdG9IZWFkaW5nU2V0dGluZ3Mge1xuXHRoaWdobGlnaHRDdXJyZW50SGVhZGluZzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IEdvdG9IZWFkaW5nU2V0dGluZ3MgPSB7XG5cdGhpZ2hsaWdodEN1cnJlbnRIZWFkaW5nOiB0cnVlXG59OyJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFBQUEsbUJBQW9GOzs7QUNFN0UsU0FBUyxzQkFBc0IsS0FBVTtBQUUvQyxNQUFJLGFBQWEsSUFBSSxVQUFVLGNBQWM7QUFDN0MsTUFBSSxDQUFDO0FBQVksV0FBTztBQUN4QixRQUFNLFlBQVksSUFBSSxjQUFjLGFBQWEsVUFBVTtBQUUzRCxTQUFPLHVDQUFXO0FBQ25CO0FBRU8sU0FBUyxrQkFBa0IsUUFBZ0IsTUFBYztBQUMvRCxTQUFPLFVBQVUsSUFBSTtBQUdyQixRQUFNLFdBQVcsT0FBTyxVQUFVO0FBQ2xDLFFBQU0sUUFBUSxPQUFPLE9BQU8sUUFBUTtBQUNwQyxNQUFJLENBQUM7QUFBTztBQUNaLFNBQU8sZUFBZSxPQUFPLElBQUk7QUFDbEM7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QU0sS0FBSyxTQUFTLENBQUM7QUFBQSxFQUMxRTtBQUFBLEVBRUEsTUFBTSxlQUFlO0FBQ3BCLFVBQU0sS0FBSyxTQUFTLEtBQUssUUFBUTtBQUFBLEVBQ2xDO0FBQUEsRUFFVSxvQkFBb0IsUUFBZ0IsTUFBb0IsUUFBZ0I7QUFDakYsUUFBSSxVQUFVO0FBQUc7QUFFakIsVUFBTSxXQUFXLHNCQUFzQixLQUFLLEdBQUc7QUFDL0MsUUFBRyxFQUFDLHFDQUFVO0FBQVE7QUFHdEIsVUFBTSxPQUFPLE9BQU8sVUFBVSxFQUFFO0FBQ2hDLFVBQU0sc0JBQXNCLFNBQVMsY0FBYyxDQUFBQyxhQUFXQSxTQUFRLFNBQVMsTUFBTSxRQUFRLElBQUk7QUFDakcsUUFBSSxzQkFBc0I7QUFBRztBQUU3QixVQUFNLGlCQUFpQixTQUFTLG1CQUFtQjtBQUNuRCxRQUFHLFVBQVUsTUFBTSxPQUFPLGVBQWUsU0FBUyxJQUFJLE1BQU07QUFDM0QsZUFBUztBQUFBLElBQ1Y7QUFHQSxRQUFJLE1BQU0sc0JBQXNCO0FBQ2hDLFFBQUcsTUFBTSxLQUFLLE9BQU8sU0FBUztBQUFRO0FBR3RDLFVBQU0sVUFBVSxTQUFTLEdBQUc7QUFDNUIsc0JBQWtCLFFBQVEsUUFBUSxTQUFTLE1BQU0sSUFBSTtBQUFBLEVBQ3REO0FBQUEsRUFFVSxvQkFBb0IsUUFBZ0IsTUFBb0I7QUFDakUsVUFBTSxXQUFXLHNCQUFzQixLQUFLLEdBQUc7QUFDL0MsUUFBRyxFQUFDLHFDQUFVO0FBQVE7QUFFdEIsUUFBSSxRQUFRLElBQUksYUFBYSxLQUFLLEdBQUc7QUFDckMsVUFBTSxnQkFBZ0I7QUFBQSxNQUNyQixFQUFFLFNBQVMsZ0JBQU0sU0FBUyxjQUFjO0FBQUEsTUFDeEMsRUFBRSxTQUFTLFVBQUssU0FBUyxxQkFBcUI7QUFBQSxNQUM5QyxFQUFFLFNBQVMsT0FBTyxTQUFTLGFBQWE7QUFBQSxJQUN6QyxDQUFDO0FBQ0QsVUFBTSxlQUFlLGtCQUFrQjtBQUV2QyxVQUFNLFFBQVEsU0FBUyxJQUFJLGNBQVk7QUFBQSxNQUN0QyxTQUFTLFFBQVE7QUFBQSxNQUNqQixPQUFPLFFBQVE7QUFBQSxNQUNmLE1BQU0sUUFBUSxTQUFTLE1BQU07QUFBQSxJQUM5QixFQUFFO0FBRUYsVUFBTSxXQUFXLENBQUMsU0FBUztBQUMxQix3QkFBa0IsUUFBUSxLQUFLLElBQUk7QUFDbkMsWUFBTSxNQUFNO0FBQUEsSUFDYjtBQUdBLFVBQU0sT0FBTyxPQUFPLFVBQVUsRUFBRTtBQUNoQyxVQUFNLG1CQUFtQixTQUFTLGNBQWMsYUFBVyxRQUFRLFNBQVMsTUFBTSxRQUFRLElBQUk7QUFDOUYsVUFBTSxXQUFXLEtBQUs7QUFFdEIsVUFBTSxLQUFLO0FBQUEsRUFDWjtBQUNEOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImhlYWRpbmciXQp9Cg==
